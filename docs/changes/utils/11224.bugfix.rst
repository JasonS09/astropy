Make ``lazyproperty`` and ``classdecorator`` thread-safe. This should fix a
number of thread safety issues.